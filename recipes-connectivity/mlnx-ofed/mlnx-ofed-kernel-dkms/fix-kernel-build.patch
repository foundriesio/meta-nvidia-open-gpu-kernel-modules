diff -Naur old/usr/src/mlnx-ofed-kernel-5.9/compat/config/build-linux.m4 new/usr/src/mlnx-ofed-kernel-5.9/compat/config/build-linux.m4
--- old/usr/src/mlnx-ofed-kernel-5.9/compat/config/build-linux.m4	2023-05-03 12:46:18.803685494 -0600
+++ new/usr/src/mlnx-ofed-kernel-5.9/compat/config/build-linux.m4	2023-05-03 12:55:12.805389651 -0600
@@ -337,7 +337,7 @@
 [m4_ifvaln([$1], [AC_LANG_CONFTEST([$1])])dnl
 MAKE=${MAKE:-make}
 rm -f build/conftest.o build/conftest.mod.c build/conftest.ko build/output.log
-AS_IF([AC_TRY_COMMAND(cp conftest.c build && env $CROSS_VARS $MAKE -d [$2] ${LD:+"LD=$CROSS_COMPILE$LD"} CC="$CROSS_COMPILE$CC" -f $PWD/build/Makefile MLNX_LINUX_CONFIG=$LINUX_CONFIG LINUXINCLUDE="-include generated/autoconf.h $XEN_INCLUDES $EXTRA_MLNX_INCLUDE -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -Iinclude -I$LINUX/arch/$SRCARCH/include/uapi -Iarch/$SRCARCH/include/generated/uapi -I$LINUX/include -I$LINUX/include/uapi -Iinclude/generated/uapi  -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -I$LINUX/arch/$SRCARCH/include -I$LINUX/arch/$SRCARCH/include/generated -I$LINUX_OBJ/include -I$LINUX/include -I$LINUX_OBJ/include2 $CONFIG_INCLUDE_FLAG" -o tmp_include_depends -o scripts -o include/config/MARKER -C $LINUX_OBJ EXTRA_CFLAGS="-Werror-implicit-function-declaration -Wno-unused-variable -Wno-uninitialized $EXTRA_KCFLAGS" $CROSS_VARS M=$PWD/build >/dev/null 2>build/output.log; [[[ $? -ne 0 ]]] && cat build/output.log 1>&2 && false || config/warning_filter.sh build/output.log) >/dev/null && AC_TRY_COMMAND([$3])],
+AS_IF([AC_TRY_COMMAND(cp conftest.c build && env $CROSS_VARS $MAKE -d [$2] ${LD:+"LD=$LD"} CC="$CC" -f $PWD/build/Makefile MLNX_LINUX_CONFIG=$LINUX_CONFIG LINUXINCLUDE="-include generated/autoconf.h $XEN_INCLUDES $EXTRA_MLNX_INCLUDE -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -Iinclude -I$LINUX/arch/$SRCARCH/include/uapi -Iarch/$SRCARCH/include/generated/uapi -I$LINUX/include -I$LINUX/include/uapi -Iinclude/generated/uapi  -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -I$LINUX/arch/$SRCARCH/include -I$LINUX/arch/$SRCARCH/include/generated -I$LINUX_OBJ/include -I$LINUX/include -I$LINUX_OBJ/include2 $CONFIG_INCLUDE_FLAG" -o tmp_include_depends -o scripts -o include/config/MARKER -C $LINUX_OBJ EXTRA_CFLAGS="-Werror-implicit-function-declaration -Wno-unused-variable -Wno-uninitialized $EXTRA_KCFLAGS" $CROSS_VARS M=$PWD/build >/dev/null 2>build/output.log; [[[ $? -ne 0 ]]] && cat build/output.log 1>&2 && false || config/warning_filter.sh build/output.log) >/dev/null && AC_TRY_COMMAND([$3])],
 	[$4],
 	[_AC_MSG_LOG_CONFTEST
 m4_ifvaln([$5],[$5])dnl])
diff -Naur old/usr/src/mlnx-ofed-kernel-5.9/compat/config/parallel-build.m4 new/usr/src/mlnx-ofed-kernel-5.9/compat/config/parallel-build.m4
--- old/usr/src/mlnx-ofed-kernel-5.9/compat/config/parallel-build.m4	2023-05-03 12:46:18.803685494 -0600
+++ new/usr/src/mlnx-ofed-kernel-5.9/compat/config/parallel-build.m4	2023-05-03 12:55:30.861579637 -0600
@@ -101,7 +101,7 @@
 tmpbuild=$(/bin/mktemp -d $PWD/build/build_XXXXX)
 /bin/cp build/Makefile $tmpbuild/
 m4_ifvaln([$1], [MLNX_AC_LANG_CONFTEST([$1])])dnl
-AS_IF([AC_TRY_COMMAND(env $CROSS_VARS $MAKE -d [$2] ${LD:+"LD=$CROSS_COMPILE$LD"} CC="$CROSS_COMPILE$CC" -f $tmpbuild/Makefile MLNX_LINUX_CONFIG=$LINUX_CONFIG LINUXINCLUDE="-include generated/autoconf.h $XEN_INCLUDES $EXTRA_MLNX_INCLUDE -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -Iinclude -I$LINUX/arch/$SRCARCH/include/uapi -Iarch/$SRCARCH/include/generated/uapi -I$LINUX/include -I$LINUX/include/uapi -Iinclude/generated/uapi  -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -I$LINUX/arch/$SRCARCH/include -I$LINUX/arch/$SRCARCH/include/generated -I$LINUX_OBJ/include -I$LINUX/include -I$LINUX_OBJ/include2 $CONFIG_INCLUDE_FLAG" -o tmp_include_depends -o scripts -o include/config/MARKER -C $LINUX_OBJ EXTRA_CFLAGS="-Werror-implicit-function-declaration -Wno-unused-variable -Wno-uninitialized $EXTRA_KCFLAGS" $CROSS_VARS M=$tmpbuild >/dev/null 2>$tmpbuild/output.log; [[[ $? -ne 0 ]]] && cat $tmpbuild/output.log 1>&2 && false || config/warning_filter.sh $tmpbuild/output.log) >/dev/null && AC_TRY_COMMAND([$3])],
+AS_IF([AC_TRY_COMMAND(env $CROSS_VARS $MAKE -d [$2] ${LD:+"LD=$LD"} CC="$CC" -f $tmpbuild/Makefile MLNX_LINUX_CONFIG=$LINUX_CONFIG LINUXINCLUDE="-include generated/autoconf.h $XEN_INCLUDES $EXTRA_MLNX_INCLUDE -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -Iinclude -I$LINUX/arch/$SRCARCH/include/uapi -Iarch/$SRCARCH/include/generated/uapi -I$LINUX/include -I$LINUX/include/uapi -Iinclude/generated/uapi  -I$LINUX/arch/$SRCARCH/include -Iarch/$SRCARCH/include/generated -I$LINUX/arch/$SRCARCH/include -I$LINUX/arch/$SRCARCH/include/generated -I$LINUX_OBJ/include -I$LINUX/include -I$LINUX_OBJ/include2 $CONFIG_INCLUDE_FLAG" -o tmp_include_depends -o scripts -o include/config/MARKER -C $LINUX_OBJ EXTRA_CFLAGS="-Werror-implicit-function-declaration -Wno-unused-variable -Wno-uninitialized $EXTRA_KCFLAGS" $CROSS_VARS M=$tmpbuild >/dev/null 2>$tmpbuild/output.log; [[[ $? -ne 0 ]]] && cat $tmpbuild/output.log 1>&2 && false || config/warning_filter.sh $tmpbuild/output.log) >/dev/null && AC_TRY_COMMAND([$3])],
 	[$4],
 	[_MLNX_AC_MSG_LOG_CONFTEST
 m4_ifvaln([$5],[$5])dnl])
diff -Naur old/usr/src/mlnx-ofed-kernel-5.9/ofed_scripts/configure new/usr/src/mlnx-ofed-kernel-5.9/ofed_scripts/configure
--- old/usr/src/mlnx-ofed-kernel-5.9/ofed_scripts/configure	2023-05-03 12:52:22.471590245 -0600
+++ new/usr/src/mlnx-ofed-kernel-5.9/ofed_scripts/configure	2023-05-03 12:53:14.952146133 -0600
@@ -784,7 +784,7 @@
         # Parsing parameters
         while [ ! -z "$1" ]
         do
-                case $1 in
+                case "$1" in
                         -prefix | --prefix | --prefi | --pref | --pre | --pr | --p | -p)
                                 shift
                                 prefix=$1
@@ -804,6 +804,9 @@
                                 ofed_patch_params="$ofed_patch_params $1"
                                 KVERSION=`expr "x$1" : 'x[^=]*=\(.*\)'`
                         ;;
+                        --configureopts=*)
+                                CONFIGUREOPTS=`expr "x$1" : 'x[^=]*=\(.*\)'`
+                        ;;
 
                         -modules-dir | --modules-dir | --mod-dir)
                                 shift
@@ -2033,7 +2036,7 @@
         /bin/cp -f Makefile.real Makefile
         /bin/cp -f Makefile.real Makefile.in
 
-        ex ./configure --with-linux-obj=$KSRC_OBJ --with-linux=$KSRC --with-njobs=$NJOBS
+        ex ./configure $CONFIGUREOPTS --with-linux-obj=$KSRC_OBJ --with-linux=$KSRC --with-njobs=$NJOBS
 
         cd -
 
@@ -2041,7 +2044,7 @@
     fi
 }
 
-main $@
+main "$@"
 if [ "X$BUILD_DUMMY_MODS" == "X1" ]; then
     echo
     echo "Going to build dummy modules for ULPs and storage drivers..."
