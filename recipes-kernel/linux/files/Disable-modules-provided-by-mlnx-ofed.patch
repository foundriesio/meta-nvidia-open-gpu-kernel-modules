From a6c03f582eb6daabcc3f6d356aba2adcede6fee6 Mon Sep 17 00:00:00 2001
From: Ian Stewart <istewart@nvidia.com>
Date: Thu, 6 Oct 2022 20:04:11 -0600
Subject: Disable modules provided by mlnx-ofed

---
 arch/arm64/configs/defconfig | 33 +++++++++++++++++----------------
 1 file changed, 17 insertions(+), 16 deletions(-)

diff --git a/arch/arm64/configs/defconfig b/arch/arm64/configs/defconfig
index de31fedcaee3..c53f3a1eb476 100644
--- a/arch/arm64/configs/defconfig
+++ b/arch/arm64/configs/defconfig
@@ -454,13 +454,13 @@ CONFIG_SKGE=m
 CONFIG_SKY2=m
 CONFIG_SKY2_DEBUG=y
 CONFIG_OAK=m
-CONFIG_MLX4_EN=m
-CONFIG_MLX5_CORE=m
-CONFIG_MLX5_CORE_EN=y
-CONFIG_MLX5_CORE_IPOIB=y
-CONFIG_MLX5_CORE_THERMAL=y
-CONFIG_MLXSW_CORE=y
-CONFIG_MLX_MFT=m
+CONFIG_MLX4_EN=n
+CONFIG_MLX5_CORE=n
+CONFIG_MLX5_CORE_EN=n
+CONFIG_MLX5_CORE_IPOIB=n
+CONFIG_MLX5_CORE_THERMAL=n
+CONFIG_MLXSW_CORE=n
+CONFIG_MLX_MFT=n
 CONFIG_LAN743X=m
 CONFIG_NATSEMI=m
 CONFIG_NS83820=m
@@ -1156,15 +1156,15 @@ CONFIG_LEDS_GPIO=m
 CONFIG_LEDS_PWM=m
 CONFIG_LEDS_BD2802=m
 CONFIG_LEDS_IS31FL319X=m
-CONFIG_INFINIBAND=m
-CONFIG_INFINIBAND_USER_MAD=m
-CONFIG_INFINIBAND_USER_ACCESS=m
-CONFIG_INFINIBAND_MTHCA=m
-CONFIG_MLX4_INFINIBAND=m
-CONFIG_MLX5_INFINIBAND=m
-CONFIG_INFINIBAND_IPOIB=m
-CONFIG_INFINIBAND_IPOIB_CM=y
-CONFIG_INFINIBAND_SRP=m
+CONFIG_INFINIBAND=n
+CONFIG_INFINIBAND_USER_MAD=n
+CONFIG_INFINIBAND_USER_ACCESS=n
+CONFIG_INFINIBAND_MTHCA=n
+CONFIG_MLX4_INFINIBAND=n
+CONFIG_MLX5_INFINIBAND=n
+CONFIG_INFINIBAND_IPOIB=n
+CONFIG_INFINIBAND_IPOIB_CM=n
+CONFIG_INFINIBAND_SRP=n
 CONFIG_RTC_CLASS=y
 CONFIG_RTC_HCTOSYS_DEVICE="rtc1"
 # CONFIG_RTC_NVMEM is not set
@@ -1373,3 +1373,4 @@ CONFIG_STACK_TRACER=y
 # CONFIG_UPROBE_EVENTS is not set
 CONFIG_PID_IN_CONTEXTIDR=y
 # CONFIG_RUNTIME_TESTING_MENU is not set
+CONFIG_MLXSW_SPECTRUM=n
-- 
2.34.1

